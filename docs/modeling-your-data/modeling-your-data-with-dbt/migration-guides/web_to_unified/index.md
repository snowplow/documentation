---
title: "Migrating from Web to Unified Digital"
sidebar_label: "Web to Unified Digital"
sidebar_position: 1000
---
```mdx-code-block
import ThemedImage from '@theme/ThemedImage';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
```

Follow this migration guide to upgrade from the legacy [Snowplow Web](/docs/modeling-your-data/modeling-your-data-with-dbt/dbt-models/legacy/dbt-web-data-model/index.md) dbt package to the [Snowplow Unified Digital](/docs/modeling-your-data/modeling-your-data-with-dbt/dbt-models/dbt-unified-data-model/index.md) package. Unified Digital is the most supported and feature-rich Snowplow dbt package, which you can use to model web and/or mobile event data.

## Simplified upgrade overview

<p align="center">
<ThemedImage
alt='Migration steps - part I'
sources={{
light: require('./images/migrate_1.png').default,
dark: require('./images/migrate_1.png').default
}}
/>
</p>

<p align="center">
<ThemedImage
alt='Migration steps - part II'
sources={{
light: require('./images/migrate_2.png').default,
dark: require('./images/migrate_2.png').default
}}
/>
</p>


## Breaking changes between the packages

- The `page_views` table has been renamed to `views`
- The `domain_userid` field has been renamed to `user_identifier`, as you now have the ability to define your own custom logic / alternative user id field for the aggregation
- The `domain_sessionid` has been renamed to `session_identifier`, as you now have the ability to define your own custom logic / alternative session id field for the aggregation
- Apart from these, fields generated by the out-of-the-box entities and enrichments have been added a prefix to indicate where they are coming from, e.g. `device_version` has been renamed to `yauaa__device_version`
- These out-of-the-box entities and enrichments can be optionally enabled or disabled for the model (previously these values were there as NULLs) through variables e.g. `snowplow__enable_yauaa: true` which are then flattened automatically within the `base_events_this_run` table and can be referred to from there directly for custom models, if needed
- Some package variables have been renamed, as well as new ones added

## Things to bear in mind

Due to the breaking changes, ideally it's best to start from scratch and run the new package on your whole historic events dataset. This could be costly in both time and effort. In certain scenarios, e.g. in case of large data volumes, it may be useful to try and upgrade instead using the existing modeled derived dataset.

There is no 100% accurate upgrade solution, but with this guide you may be able to get 95% of the way there.

1. **Incomplete or inaccurate fields for historic data**: the unified package contains a list of new fields, some of which we can compute on a row-by-row basis, in which case we provided update scripts to compute them for your existing derived data. There are, however, a few other new fields that are a result of aggregate or other computation that we cannot calculate without a full refresh. E.g. `absolute_time_in_s` for users therefore they will stay `NULL`. Then when a new event comes to update that record it may either correct it or it will just be inaccurate.

2. **Fields that aren't available in the out-of-the-box derived tables**: there are a few fields that we've dropped as they were incorporated into a new field based on different grouping. There may also be custom fields you have added to the derived tables. The below passthrough variables come in handy in this case:
```yml
    snowplow__view_passthroughs: []
    snowplow__session_passthroughs: []
    snowplow__user_first_passthroughs: []
    snowplow__user_last_passthroughs: []
```
For more on this, have a look at the [passthrough fields](/docs/modeling-your-data/modeling-your-data-with-dbt/package-features/passthrough-fields/index.md) section.


## Upgrade steps

### Step 1: Migrate to the latest version of the Web package

Once you decided you would like to go ahead with the upgrade process you will first need to make sure your version of the web model is version 1.0.0 or version 1.0.1. The [Web model migration guides](/docs/modeling-your-data/modeling-your-data-with-dbt/migration-guides/web/index.md) will help you decide what other changes you need to take into consideration. If the changes apply to your warehouse, you may need to execute the upgrade SQL scripts to bridge the gap.


### Step 2: Execute SQL scripts to create the new tables

The provided SQL scripts will first create the new tables based on your existing derived tables created by the web package. Secondly, they will make the changes i.e. renaming, adding, dropping, and updating columns wherever possible, including in the manifest tables. You will then have everything ready for a new run in the Unified Digital package as if nothing happened.

Update `(your_schema)` in the SQL scripts to match your derived schema name. Execute the scripts with your database IDE to create your new derived and manifest tables without having to reprocess your event data from scratch.

You might need to adjust the data `varchar` data type to `string` depending on your warehouse (most likely to be relevant for BigQuery or Databricks users) or limit it to the maximum in case there are limitations (potentially Redshift).


<details>
  <summary>SQL scripts</summary>

```sql
create table (your_schema)_derived.snowplow_unified_views as (select * from (your_schema)_derived.snowplow_web_page_views);
create table (your_schema)_derived.snowplow_unified_sessions as (select * from (your_schema)_derived.snowplow_web_sessions);
create table (your_schema)_derived.snowplow_unified_users as (select * from (your_schema)_derived.snowplow_web_users);
create table (your_schema)_snowplow_manifest.snowplow_unified_incremental_manifest as (select * from (your_schema)_snowplow_manifest.snowplow_web_incremental_manifest);
create table (your_schema)_snowplow_manifest.snowplow_unified_base_sessions_lifecycle_manifest as (select * from (your_schema)_snowplow_manifest.snowplow_web_base_sessions_lifecycle_manifest)

alter table (your_schema)_derived.snowplow_unified_views rename column domain_sessionid to session_identifier;
alter table (your_schema)_derived.snowplow_unified_views rename column domain_userid to user_identifier;
alter table (your_schema)_derived.snowplow_unified_views rename column original_domain_userid to device_identifier;
alter table (your_schema)_derived.snowplow_unified_views drop column original_domain_sessionid;
alter table (your_schema)_derived.snowplow_unified_views rename column agent_class to yauaa__agent_class;
alter table (your_schema)_derived.snowplow_unified_views rename column agent_name to yauaa__agent_name;
alter table (your_schema)_derived.snowplow_unified_views rename column agent_name_version to yauaa__agent_name_version;
alter table (your_schema)_derived.snowplow_unified_views rename column agent_name_version_major to yauaa__agent_name_version_major;
alter table (your_schema)_derived.snowplow_unified_views rename column agent_version to yauaa__agent_version;
alter table (your_schema)_derived.snowplow_unified_views rename column agent_version_major to yauaa__agent_version_major;
alter table (your_schema)_derived.snowplow_unified_views rename column category to iab__category;
alter table (your_schema)_derived.snowplow_unified_views drop column device_brand;
alter table (your_schema)_derived.snowplow_unified_views rename column device_class to yauaa__device_class;
alter table (your_schema)_derived.snowplow_unified_views rename column device_family to ua__device_family;
alter table (your_schema)_derived.snowplow_unified_views rename column device_name to yauaa__device_name;
alter table (your_schema)_derived.snowplow_unified_views rename column device_version to yauaa__device_version;
alter table (your_schema)_derived.snowplow_unified_views rename column domain_sessionidx to device_session_index;
alter table  (your_schema)_derived.snowplow_unified_views rename column layout_engine_class to yauaa__layout_engine_class;
alter table  (your_schema)_derived.snowplow_unified_views rename column layout_engine_name to yauaa__layout_engine_name;
alter table  (your_schema)_derived.snowplow_unified_views rename column layout_engine_name_version to yauaa__layout_engine_name_version;
alter table  (your_schema)_derived.snowplow_unified_views rename column layout_engine_name_version_major to yauaa__layout_engine_name_version_major;
alter table  (your_schema)_derived.snowplow_unified_views rename column layout_engine_version to yauaa__layout_engine_version;
alter table  (your_schema)_derived.snowplow_unified_views rename column layout_engine_version_major to yauaa__layout_engine_version_major;
alter table  (your_schema)_derived.snowplow_unified_views rename column operating_system_class to yauaa__operating_system_class;
alter table  (your_schema)_derived.snowplow_unified_views rename column operating_system_name to yauaa__operating_system_name;
alter table  (your_schema)_derived.snowplow_unified_views rename column operating_system_name_version to yauaa__operating_system_name_version;
alter table  (your_schema)_derived.snowplow_unified_views rename column operating_system_version to yauaa__operating_system_version;
alter table  (your_schema)_derived.snowplow_unified_views drop column os_family;
alter table  (your_schema)_derived.snowplow_unified_views rename column os_major to ua__os_major;
alter table  (your_schema)_derived.snowplow_unified_views rename column os_minor to ua__os_minor;
alter table  (your_schema)_derived.snowplow_unified_views rename column os_patch to ua__os_patch;
alter table  (your_schema)_derived.snowplow_unified_views rename column os_patch_minor to ua__os_patch_minor;
alter table  (your_schema)_derived.snowplow_unified_views rename column os_version to ua__os_version;
alter table  (your_schema)_derived.snowplow_unified_views rename column page_views_in_session to views_in_session;
alter table  (your_schema)_derived.snowplow_unified_views rename column page_view_id to view_id;
alter table  (your_schema)_derived.snowplow_unified_views rename column page_view_in_session_index to view_in_session_index;
alter table  (your_schema)_derived.snowplow_unified_views rename column primary_impact to iab__primary_impact;
alter table  (your_schema)_derived.snowplow_unified_views rename column reason to iab__reason;
alter table  (your_schema)_derived.snowplow_unified_views rename column spider_or_robot to iab__spider_or_robot;
alter table  (your_schema)_derived.snowplow_unified_views rename column useragent_family to ua__useragent_family;
alter table  (your_schema)_derived.snowplow_unified_views rename column useragent_major to ua__useragent_major;
alter table  (your_schema)_derived.snowplow_unified_views rename column useragent_minor to ua__useragent_minor;
alter table  (your_schema)_derived.snowplow_unified_views rename column useragent_patch to ua__useragent_patch;
alter table  (your_schema)_derived.snowplow_unified_views rename column useragent_version to ua__useragent_version;
alter table  (your_schema)_derived.snowplow_unified_views add column if not exists default_channel_group varchar(25);
alter table  (your_schema)_derived.snowplow_unified_views add column event_name varchar(1000);
update (your_schema)_derived.snowplow_unified_views
set event_name = 'page_view'
where 1=1;
alter table  (your_schema)_derived.snowplow_unified_views add column os_type varchar(16777216);
alter table  (your_schema)_derived.snowplow_unified_views add column os_version varchar(16777216);
alter table  (your_schema)_derived.snowplow_unified_views add column session__previous_session_id varchar(36);
alter table  (your_schema)_derived.snowplow_unified_views add column if not exists stitched_user_id varchar(16777216);

alter table (your_schema)_derived.snowplow_unified_sessions rename column domain_sessionid to session_identifier;
alter table (your_schema)_derived.snowplow_unified_sessions rename column domain_userid to user_identifier;
alter table (your_schema)_derived.snowplow_unified_sessions rename column original_domain_userid to device_identifier;
alter table (your_schema)_derived.snowplow_unified_sessions drop column original_domain_sessionid;
alter table (your_schema)_derived.snowplow_unified_sessions rename column agent_class to yauaa__agent_class;
alter table (your_schema)_derived.snowplow_unified_sessions rename column agent_name to yauaa__agent_name;
alter table (your_schema)_derived.snowplow_unified_sessions rename column agent_name_version to yauaa__agent_name_version;
alter table (your_schema)_derived.snowplow_unified_sessions rename column agent_name_version_major to yauaa__agent_name_version_major;
alter table (your_schema)_derived.snowplow_unified_sessions rename column agent_version to yauaa__agent_version;
alter table (your_schema)_derived.snowplow_unified_sessions rename column agent_version_major to yauaa__agent_version_major;
alter table (your_schema)_derived.snowplow_unified_sessions rename column br_lang to first_br_lang;
alter table (your_schema)_derived.snowplow_unified_sessions rename column br_lang_name to first_br_lang_name;
alter table (your_schema)_derived.snowplow_unified_sessions rename column category to iab__category;
alter table (your_schema)_derived.snowplow_unified_sessions drop column device_brand;
alter table (your_schema)_derived.snowplow_unified_sessions rename column device_class to yauaa__device_class;
alter table (your_schema)_derived.snowplow_unified_sessions rename column device_family to ua__device_family;
alter table (your_schema)_derived.snowplow_unified_sessions rename column device_name to yauaa__device_name;
alter table (your_schema)_derived.snowplow_unified_sessions rename column device_version to yauaa__device_version;
alter table (your_schema)_derived.snowplow_unified_sessions rename column domain_sessionidx to device_session_index;
alter table (your_schema)_derived.snowplow_unified_sessions rename column geo_city to first_geo_city;
alter table (your_schema)_derived.snowplow_unified_sessions rename column geo_continent to first_geo_continent;
alter table (your_schema)_derived.snowplow_unified_sessions rename column geo_country to first_geo_country;
alter table (your_schema)_derived.snowplow_unified_sessions rename column geo_country_name to first_geo_country_name;
alter table (your_schema)_derived.snowplow_unified_sessions drop column geo_region;
alter table (your_schema)_derived.snowplow_unified_sessions rename column geo_region_name to first_geo_region_name;
alter table (your_schema)_derived.snowplow_unified_sessions rename column layout_engine_class to yauaa__layout_engine_class;
alter table (your_schema)_derived.snowplow_unified_sessions rename column layout_engine_name to yauaa__layout_engine_name;
alter table (your_schema)_derived.snowplow_unified_sessions rename column layout_engine_name_version to yauaa__layout_engine_name_version;
alter table (your_schema)_derived.snowplow_unified_sessions rename column layout_engine_name_version_major to yauaa__layout_engine_name_version_major;
alter table (your_schema)_derived.snowplow_unified_sessions rename column layout_engine_version to yauaa__layout_engine_version;
alter table (your_schema)_derived.snowplow_unified_sessions rename column layout_engine_version_major to yauaa__layout_engine_version_major;
alter table (your_schema)_derived.snowplow_unified_sessions rename column operating_system_class to yauaa__operating_system_class;
alter table (your_schema)_derived.snowplow_unified_sessions rename column operating_system_name to yauaa__operating_system_name;
alter table (your_schema)_derived.snowplow_unified_sessions rename column operating_system_name_version to yauaa__operating_system_name_version;
alter table (your_schema)_derived.snowplow_unified_sessions rename column operating_system_version to yauaa__operating_system_version;
alter table (your_schema)_derived.snowplow_unified_sessions drop column os_family;
alter table (your_schema)_derived.snowplow_unified_sessions rename column os_major to ua__os_major;
alter table (your_schema)_derived.snowplow_unified_sessions rename column os_minor to ua__os_minor;
alter table (your_schema)_derived.snowplow_unified_sessions rename column os_patch to ua__os_patch;
alter table (your_schema)_derived.snowplow_unified_sessions rename column os_patch_minor to ua__os_patch_minor;
alter table (your_schema)_derived.snowplow_unified_sessions rename column page_views to views;
alter table (your_schema)_derived.snowplow_unified_sessions rename column primary_impact to iab__primary_impact;
alter table (your_schema)_derived.snowplow_unified_sessions rename column reason to iab__reason;
alter table (your_schema)_derived.snowplow_unified_sessions rename column referrer to page_referrer;
alter table (your_schema)_derived.snowplow_unified_sessions rename column spider_or_robot to iab__spider_or_robot;
alter table (your_schema)_derived.snowplow_unified_sessions rename column useragent_family to ua__useragent_family;
alter table (your_schema)_derived.snowplow_unified_sessions rename column useragent_major to ua__useragent_major;
alter table (your_schema)_derived.snowplow_unified_sessions rename column useragent_minor to ua__useragent_minor;
alter table (your_schema)_derived.snowplow_unified_sessions rename column useragent_patch to ua__useragent_patch;
alter table (your_schema)_derived.snowplow_unified_sessions rename column useragent_version to ua__useragent_version;
alter table (your_schema)_derived.snowplow_unified_sessions add column os_type varchar(16777216);
alter table (your_schema)_derived.snowplow_unified_sessions add column session_duration_s number(18,0);
alter table (your_schema)_derived.snowplow_unified_sessions add column session__previous_session_id varchar(36);
alter table (your_schema)_derived.snowplow_unified_sessions add column first_event_name varchar(1000);
alter table (your_schema)_derived.snowplow_unified_sessions add column last_event_name varchar(1000);
alter table  (your_schema)_derived.snowplow_unified_sessions add column if not exists stitched_user_id varchar(16777216);

alter table (your_schema)_derived.snowplow_unified_users rename column domain_userid to user_identifier;
alter table (your_schema)_derived.snowplow_unified_users drop column original_domain_userid;
alter table (your_schema)_derived.snowplow_unified_users rename column page_views to views;
alter table (your_schema)_derived.snowplow_unified_users rename column referrer to page_referrer;
alter table (your_schema)_derived.snowplow_unified_users add column on_mobile boolean;
update (your_schema)_derived.snowplow_unified_users
set on_mobile = false
where 1=1;
alter table (your_schema)_derived.snowplow_unified_users add column on_web boolean;
update (your_schema)_derived.snowplow_unified_users
set on_web = true
where 1=1;
alter table (your_schema)_derived.snowplow_unified_users add column screen_names_viewed number(30,0);
alter table (your_schema)_derived.snowplow_unified_users add column sessions_duration_s number(30,0);
alter table (your_schema)_derived.snowplow_unified_users add column active_days number(18,0);
alter table (your_schema)_derived.snowplow_unified_users add column last_platform varchar(255);
update (your_schema)_derived.snowplow_unified_users
set last_platform = 'web'
where 1=1;
alter table (your_schema)_derived.snowplow_unified_users add column last_screen_resolution varchar(16777216);
alter table (your_schema)_derived.snowplow_unified_users add column last_os_type varchar(16777216);
alter table (your_schema)_derived.snowplow_unified_users add column last_os_version varchar(16777216);
alter table (your_schema)_derived.snowplow_unified_users add column first_platform varchar(255);
update (your_schema)_derived.snowplow_unified_users
set first_platform = 'web'
where 1=1;
alter table (your_schema)_derived.snowplow_unified_users add column geo_latitude float;
alter table (your_schema)_derived.snowplow_unified_users add column geo_longitude float;
alter table (your_schema)_derived.snowplow_unified_users add column geo_timezone varchar(64);
alter table (your_schema)_derived.snowplow_unified_users add column geo_zipcode varchar(15);
alter table  (your_schema)_derived.snowplow_unified_users add column if not exists stitched_user_id varchar(16777216);

update (your_schema)_snowplow_manifest.snowplow_unified_incremental_manifest
set model = replace(model, 'snowplow_web', 'snowplow_unified')
where 1=1;

update (your_schema)_snowplow_manifest.snowplow_unified_incremental_manifest
set model = case when model = 'snowplow_unified_page_views_this_run' then 'snowplow_unified_views_this_run'
when model = 'snowplow_unified_page_views' then 'snowplow_unified_views' else model end
where 1=1;

```
</details>

### Step 3: Setting up a new dbt project for Unified Digital

Due to a package conflict resulting from the last Web and Unified Digital releases requiring a different version of the `snowplow-utils` package, it's probably best to create a new dbt project for running the package.

**3.1 Packages.yml**

```yml
packages:
  - package: snowplow/snowplow_unified
    version: 0.4.1
```

**3.2 Project.yml**

In the project.yml file, disable the mobile events:

```yml
vars:
  snowplow_unified:
    snowplow__enable_mobile: false
```

If you changed any of the default variables in your web project, add them here as well. While 90% of the variables stayed the same, there are some notable changes, deletions, additions, and default modifications. Have a look below or at the detailed [configuration](/docs/modeling-your-data/modeling-your-data-with-dbt/dbt-configuration/index.md) page and adjust accordingly:

**Removed variables:**
- `snowplow__limit_page_views_to_session`

**Renamed variables:**
- `snowplow__page_view_stitching` to `snowplow__view_stitching`
- `snowplow__consent_cmp_visible` to `snowplow__cmp_visible_events` (Redshift only)
- `snowplow__consent_preferences` to `snowplow__consent_preferences_events` (Redshift only)
- `snowplow__cwv_context` to `snowplow__cwv_events` (Redshift only)

**Added variables:**
- `snowplow__conversion_stitching`
- `snowplow__conversion_passthroughs`
- `snowplow__enable_browser_context`
- `snowplow__enable_app_errors`
- `snowplow__enable_conversions`
- `snowplow__use_refr_if_mkt_null`
- `snowplow__browser_context`: com_snowplowanalytics_snowplow_browser_context_1 (Redshift only)
- `snowplow__session_context`: com_snowplowanalytics_snowplow_client_session_1 (Redshift only)
- `snowplow__mobile_context`: com_snowplowanalytics_snowplow_mobile_context_1 (Redshift only)
- `snowplow__geolocation_context`: com_snowplowanalytics_snowplow_geolocation_context_1 (Redshift only)
- `snowplow__application_context`: com_snowplowanalytics_mobile_application_1 (Redshift only)
- `snowplow__screen_context`: com_snowplowanalytics_mobile_screen_1 (Redshift only)
- `snowplow__application_error_events`: com_snowplowanalytics_snowplow_application_error_1 (Redshift only)
- `snowplow__screen_view_events`: com_snowplowanalytics_mobile_screen_view_1 (Redshift only)
- `snowplow__deep_link_context`: com_snowplowanalytics_mobile_deep_link_1 (Redshift only)
- `snowplow__screen_summary_context`: com_snowplowanalytics_mobile_screen_summary_1 (Redshift only)

**Variables with changed defaults:**
- `snowplow__session_identifiers`: `[{"schema" : "atomic", "field" : "domain_sessionid"}]`
- `snowplow__user_identifiers`: `[{"schema": "atomic", "field" : "domain_userid"}]`
to none
- `snowplow__databricks_catalog`: `hive_metastore`


### Step 4: Verifying the new derived datasets

At this stage you could potentially run both packages simultaneously until you are happy to stop the old jobs that updated the Web package.

If you used the original derived tables as a source for your BI tool or for downstream data models, you can use the views below to replicate the original tables. This can help you maintain your existing reporting.

<details>
  <summary>SQL scripts to create views</summary>

```sql
create view (your_schema)_derived.mock_snowplow_web_page_views as (
  select
    view_id as page_view_id,
    event_id,
    app_id,
    platform,
    user_id,
    user_identifier as domain_userid,
    device_identifier as original_domain_userid,
    stitched_user_id,
    network_userid,
    session_identifier as domain_sessionid,
    null as original_domain_sessionid,
    device_session_index as domain_sessionidx,
    view_in_session_index as page_view_in_session_index,
    views_in_session as page_views_in_session,
    dvce_created_tstamp,
    collector_tstamp,
    derived_tstamp,
    start_tstamp,
    end_tstamp,
    model_tstamp,
    engaged_time_in_s,
    absolute_time_in_s,
    horizontal_pixels_scrolled,
    vertical_pixels_scrolled,
    horizontal_percentage_scrolled,
    vertical_percentage_scrolled,
    doc_width,
    doc_height,
    content_group,
    page_title,
    page_url,
    page_urlscheme,
    page_urlhost,
    page_urlpath,
    page_urlquery,
    page_urlfragment,
    mkt_medium,
    mkt_source,
    mkt_term,
    mkt_content,
    mkt_campaign,
    mkt_clickid,
    mkt_network,
    default_channel_group,
    page_referrer,
    refr_urlscheme,
    refr_urlhost,
    refr_urlpath,
    refr_urlquery,
    refr_urlfragment,
    refr_medium,
    refr_source,
    refr_term,
    geo_country,
    geo_region,
    geo_region_name,
    geo_city,
    geo_zipcode,
    geo_latitude,
    geo_longitude,
    geo_timezone,
    user_ipaddress,
    useragent,
    br_lang,
    br_viewwidth,
    br_viewheight,
    br_colordepth,
    br_renderengine,
    os_timezone,
    iab__category as category,
    iab__primary_impact as primary_impact,
    iab__reason as reason,
    iab__spider_or_robot as spider_or_robot,
    ua__useragent_family as useragent_family,
    ua__useragent_major as useragent_major,
    ua__useragent_minor as useragent_minor,
    ua__useragent_patch as useragent_patch,
    ua__useragent_version as useragent_version,
    ua__os_family as  os_family,
    ua__os_major as os_major,
    ua__os_minor as os_minor,
    ua__os_patch as os_patch,
    ua__os_patch_minor as os_patch_minor,
    ua__os_version as os_version,
    ua__device_family as device_family,
    yauaa__device_class as device_class,
    case
        when device_class = 'Desktop' then 'Desktop'
        when device_class = 'Phone' then 'Mobile'
        when device_class = 'Tablet' then 'Tablet'
        else 'Other'
    end as device_category,
    screen_resolution,
    yauaa__agent_class as agent_class,
    yauaa__agent_name as agent_name,
    yauaa__agent_name_version as agent_name_version,
    yauaa__agent_name_version_major as agent_name_version_major,
    yauaa__agent_version as agent_version,
    yauaa__agent_version_major as agent_version_major,
    yauaa__device_brand as device_brand,
    yauaa__device_name as device_name,
    yauaa__device_version as device_version,
    yauaa__layout_engine_class as layout_engine_class,
    yauaa__layout_engine_name as layout_engine_name,
    yauaa__layout_engine_name_version as layout_engine_name_version,
    yauaa__layout_engine_name_version_major as layout_engine_name_version_major,
    yauaa__layout_engine_version as layout_engine_version,
    yauaa__layout_engine_version_major as layout_engine_version_major,
    yauaa__operating_system_class as operating_system_class,
    yauaa__operating_system_name as operating_system_name,
    yauaa__operating_system_name_version as operating_system_name_version,
    yauaa__operating_system_version as operating_system_version,
  from (your_schema)_derived.snowplow_unified_views
);

create view (your_schema)_derived.mock_snowplow_web_sessions as (
  select
    app_id,
    platform,
    session_identifier as domain_sessionid,
    null as original_domain_sessionid,
    device_session_index as domain_sessionidx,
    start_tstamp,
    end_tstamp,
    model_tstamp,
    user_id,
    user_identifier as domain_userid,
    device_identifier as original_domain_userid,
    stitched_user_id,
    network_userid,
    views as page_views,
    engaged_time_in_s,
    total_events,
    is_engaged,
    absolute_time_in_s,
    first_page_title,
    first_page_url,
    first_page_urlscheme,
    first_page_urlhost,
    first_page_urlpath,
    first_page_urlquery,
    first_page_urlfragment,
    last_page_title,
    last_page_url,
    last_page_urlscheme,
    last_page_urlhost,
    last_page_urlpath,
    last_page_urlquery,
    last_page_urlfragment,
    page_referrer as referrer,
    refr_urlscheme,
    refr_urlhost,
    refr_urlpath,
    refr_urlquery,
    refr_urlfragment,
    refr_medium,
    refr_source,
    refr_term,
    mkt_medium,
    mkt_source,
    mkt_term,
    mkt_content,
    mkt_campaign,
    mkt_clickid,
    mkt_network,
    mkt_source_platform,
    default_channel_group,
    first_geo_country as geo_country,
    null as geo_region,
    first_geo_region_name as geo_region_name,
    first_geo_city as geo_city,
    geo_zipcode,
    geo_latitude,
    geo_longitude,
    geo_timezone,
    first_geo_country_name as geo_country_name,
    first_geo_continent as geo_continent,
    last_geo_country,
    last_geo_region_name,
    last_geo_city,
    last_geo_country_name,
    last_geo_continent,
    user_ipaddress,
    useragent,
    br_renderengine,
    first_br_lang as br_lang,
    first_br_lang_name as br_lang_name,
    last_br_lang,
    last_br_lang_name,
    os_timezone,
    iab__category as category,
    iab__primary_impact as primary_impact,
    iab__reason as reason,
    iab__spider_or_robot as spider_or_robot,
    ua__useragent_family as useragent_family,
    ua__useragent_major as useragent_major,
    ua__useragent_minor as useragent_minor,
    ua__useragent_patch as useragent_patch,
    ua__useragent_version as useragent_version,
    null as  os_family,
    ua__os_major as os_major,
    ua__os_minor as os_minor,
    ua__os_patch as os_patch,
    ua__os_patch as os_patch_minor,
    os_version,
    ua__device_family as device_family,
    yauaa__device_class as device_class,
    device_category,
    screen_resolution,
    yauaa__agent_class as agent_class,
    yauaa__agent_name as agent_name,
    yauaa__agent_name_version as agent_name_version,
    yauaa__agent_name_version_major as agent_name_version_major,
    yauaa__agent_version as agent_version,
    yauaa__agent_version_major as agent_version_major,
    null as device_brand,
    yauaa__device_name as device_name,
    yauaa__device_version as device_version,
    yauaa__layout_engine_class as layout_engine_class,
    yauaa__layout_engine_name as layout_engine_name,
    yauaa__layout_engine_name_version as layout_engine_name_version,
    yauaa__layout_engine_name_version_major as layout_engine_name_version_major,
    yauaa__layout_engine_version as layout_engine_version,
    yauaa__layout_engine_version_major as layout_engine_version_major,
    yauaa__operating_system_class as operating_system_class,
    yauaa__operating_system_name as operating_system_name,
    yauaa__operating_system_name_version as operating_system_name_version,
    yauaa__operating_system_version as operating_system_version
  from (your_schema)_derived.snowplow_unified_sessions
);

create view (your_schema)_derived.mock_snowplow_web_users as (
  select
    user_id,
    user_identifier as domain_userid,
    null as original_domain_userid,
    network_userid,
    start_tstamp,
    end_tstamp,
    model_tstamp,
    views as pageviews,
    sessions,
    engaged_time_in_s,
    first_page_title,
    first_page_url,
    first_page_urlscheme,
    first_page_urlhost,
    first_page_urlpath,
    first_page_urlquery,
    first_page_urlfragment,
    first_geo_country,
    first_geo_country_name,
    first_geo_continent,
    first_geo_city,
    first_geo_region_name,
    first_br_lang,
    first_br_lang_name,
    last_geo_country,
    last_geo_country_name,
    last_geo_continent,
    last_geo_city,
    last_geo_region_name,
    last_br_lang,
    last_br_lang_name,
    last_page_title,
    last_page_url,
    last_page_urlscheme,
    last_page_urlhost,
    last_page_urlpath,
    last_page_urlquery,
    last_page_urlfragment,
    page_referrer as referrer,
    refr_urlscheme,
    refr_urlhost,
    refr_urlpath,
    refr_urlquery,
    refr_urlfragment,
    refr_medium,
    refr_source,
    refr_term,
    mkt_medium,
    mkt_source,
    mkt_term,
    mkt_content,
    mkt_campaign,
    mkt_clickid,
    mkt_network,
    mkt_source_platform,
    default_channel_group
    from (your_schema)_derived.snowplow_unified_users
);
```
</details>
